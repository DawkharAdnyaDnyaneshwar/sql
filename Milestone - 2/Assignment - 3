<!-- Project Cont'd
Consider an online video-sharing platform like YouTube which hosts tens of thousands of channels and crores of users.

You have to analyse the data and provide meaningful insights on the type of content that drives engagement, users growth, and many more to all the stakeholders. Let’s roll our sleeves up for an insightful analysis!

Database
The given database consists of tables that stores the information of online video-sharing platform. 

Tables
user table
channel table
video table
genre table
channel_user table
user_likes table
video_genre table
Let’s dive in to analyze the in and outs of each part of the data. Here we go! -->

<!-- Questions -->
<!-- 1.
Fetch the top 10 videos having more number of views.

Note:
Output must contain rows with the highest no_of_views first.
If two videos have the same no_of_views, then sort by name in alphabetical order.
Expected Output Format:
name	no_of_views
...	    ... -->

SELECT
  name,
  no_of_views
FROM
  video
ORDER BY
  no_of_views DESC,
  name ASC
LIMIT
  10;

<!-- 2.
Get all the review videos i.e., videos which contain "review" in their name.

Note:
Output must contain rows with the highest no_of_views first.
Expected Output Format:
name	no_of_views
...	    ... -->

SELECT
  name,
  no_of_views
FROM
  video
WHERE
  name LIKE "%review%"
ORDER BY
  no_of_views DESC;

<!-- 3.
Get the total number of channels in the database.

Expected Output Format
no_of_channels
... -->

SELECT
  COUNT(channel_id) AS no_of_channels
FROM
  channel;

<!-- 4.
Get all the music videos released before the year 2016.

Note:
You can consider the videos which contain "music" in name as music videos.
Get the year in the integer format
Sort the output in the descending order of year, and then in the ascending order of name.
Expected Output Format:
name	no_of_views	year
...	    ...	        ... -->

SELECT
  name,
  no_of_views,
  CAST(strftime("%Y", published_datetime) AS INTEGER) AS year
FROM
  video
WHERE
  year < 2016
  AND name LIKE "%music%"
ORDER BY
  year DESC,
  name ASC;

<!-- 5.
Get the total number of countries where the users of the platform are present.

Expected Output Format
country_count
... -->

SELECT
  COUNT(DISTINCT country) AS country_count
FROM
  user;

<!-- 6.
Find the number of videos published between the years 2010 & 2016.

Note:
Sort the output in the ascending order of the year
Keep the year in the integer format
Expected Output Format:
year	no_of_videos
...	    ... -->

SELECT
  CAST(strftime("%Y", published_datetime) AS INTEGER) AS year,
  COUNT(video_id) AS no_of_videos
FROM
  video
WHERE
  year BETWEEN 2010
  AND 2016
GROUP BY
  year
ORDER BY
  year ASC;

<!-- 7.
Fetch the top 10 videos having more number of views, along with the channel details.

Note:
Sort the output in the descending order of no_of_views, and then in the ascending order of channel_name.

Expected Output Format:
video_name	no_of_views	channel_name
...	        ...	        ... -->

SELECT
  video.name AS video_name,
  video.no_of_views,
  channel.name AS channel_name
FROM
  video
  INNER JOIN channel ON video.channel_id = channel.channel_id
ORDER BY
  no_of_views DESC,
  channel_name ASC
LIMIT
  10;

<!-- 8.
Get all the unique channels that published review videos.

Note:
You can consider the videos which contain "review" in name as review videos.
Sort the output in the ascending order of channel_name.
Expected Output Format:
channel_id	channel_name
...	        ... -->

SELECT
  DISTINCT channel.channel_id,
  channel.name AS channel_name
FROM
  video
  INNER JOIN channel ON video.channel_id = channel.channel_id
WHERE
  video.name LIKE "%review%"
ORDER BY
  channel_name ASC;

<!-- 9.
Get all the videos that belong to "Action" genre (genre_id = 201) and have more than 1 lakh views.

Note:
Sort the output in the ascending order of video_id.
Expected Output Format:
video_id	name	genre_id
...	        ...	    ... -->

SELECT
  video.video_id,
  video.name,
  video_genre.genre_id
FROM
  video
  INNER JOIN video_genre ON video.video_id = video_genre.video_id
WHERE
  video_genre.genre_id = 201
  AND video.no_of_views > 100000
ORDER BY
  video.video_id ASC;

<!-- 10.
Get the total number of users subscribed for the channel "Tyler Oakley" (channel_id = 376) in the year 2018.

Expected Output Format
no_of_subscribers
... -->

SELECT
  COUNT(user_id) AS no_of_subscribers
FROM
  channel_user
WHERE
  channel_id = 376
  AND strftime("%Y", subscribed_datetime) = "2018";

<!-- 11.
Insights about users:
Get the geographic distribution of Taylor Swift channel (channel_id = 399) subscribers.

Note:
Geographic distribution: Number of Taylor Swift subscribers present in each country. Ignore the countries whereno_of_subscribersis 0.
Order the result in the ascending order of the country name.
Expected Output Format
country	no_of_subscribers
...	    ... -->

SELECT
  user.country,
  COUNT(
    CASE
      WHEN channel_user.user_id THEN 1
      ELSE NULL
    END
  ) AS no_of_subscribers
FROM
  channel_user
  INNER JOIN user ON user.user_id = channel_user.user_id
WHERE
  channel_user.channel_id = 399
GROUP BY
  country
ORDER BY
  country ASC;

<!-- 12.
Between 2010 & 2020, find the number of videos released in each of the below genres.

Note:
genre_ids : 201, 202, 204, 205, 206, 207
Sort the output in the descending order of no_of_videos, and then in the ascending order of genre_id.
Expected Output Format:
genre_id	no_of_videos
...	        ... -->

SELECT
  video_genre.genre_id,
  COUNT(video_genre.video_id) AS no_of_videos
FROM
  video_genre
  INNER JOIN video ON video_genre.video_id = video.video_id
WHERE
  video_genre.genre_id IN (201, 202, 204, 205, 206, 206, 207)
  AND CAST(strftime("%Y", published_datetime) AS INTEGER) BETWEEN 2010
  AND 2020
GROUP BY
  genre_id
ORDER BY
  no_of_videos DESC,
  genre_id ASC;

<!-- 13.
Get all the Indian users details whose age is below 30 years and liked the video (video_id = 1011) in the year 2020.

Note:
Consider the name of the country as "INDIA"
Consider reaction_type LIKE as liked.
Sort the output in the ascending order of name.
Expected Output Format:
name	gender	age	country	premium_membership
...	    ...	    ...	...	    ... -->

SELECT
  user.name,
  user.gender,
  user.age,
  user.country,
  user.premium_membership
FROM
  user
  INNER JOIN user_likes ON user.user_id = user_likes.user_id
WHERE
  country = "INDIA"
  AND reaction_type = "LIKE"
  AND age < 30
  AND video_id = 1011
  AND strftime("%Y", reacted_at) = "2020"
ORDER BY
  name ASC;

<!-- 14.
Get the total number of countries where the subscribers of the Taylor Swift channel (channel_id = 399) are present.

Expected Output Format
country_count
... -->

SELECT
  COUNT(DISTINCT user.country) AS country_count
FROM
  user
  INNER JOIN channel_user ON user.user_id = channel_user.user_id
WHERE
  channel_id = 399;

<!-- 15.
Get all distinct channels which published music videos before 2016.

Note:
You can consider the videos which contain "music" in name as music videos.
Sort the output in the ascending order of chanel_name.
Expected Output Format:
channel_id	channel_name
...	        ... -->

SELECT
  DISTINCT channel.channel_id,
  channel.name AS channel_name
FROM
  video
  INNER JOIN channel ON video.channel_id = channel.channel_id
WHERE
  CAST(strftime("%Y", published_datetime) AS INTEGER) < 2016
  AND video.name LIKE "%music%"
ORDER BY
  channel_name ASC;